<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="学习了MYBATIS,记录一波      Mybatis简介 MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，是一个基于Java的持久层框架。  持久层： 可以将业务数据存储到磁盘，具备长期存储能力，只要磁盘不损坏，在断电或者其他情况下，重新开启系统仍">
<meta name="keywords" content="Java">
<meta property="og:type" content="article">
<meta property="og:title" content="ssm基础之MyBatis">
<meta property="og:url" content="https://p0rz9.github.io/2019/01/23/Mybatis/index.html">
<meta property="og:site_name" content="P0rZ9&#39;s blog">
<meta property="og:description" content="学习了MYBATIS,记录一波      Mybatis简介 MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，是一个基于Java的持久层框架。  持久层： 可以将业务数据存储到磁盘，具备长期存储能力，只要磁盘不损坏，在断电或者其他情况下，重新开启系统仍">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-22.20.51.18-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-22.23.40.15-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.11.35.57-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.11.42.33-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.12.28.48-image.png">
<meta property="og:updated_time" content="2019-01-23T09:04:17.219Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ssm基础之MyBatis">
<meta name="twitter:description" content="学习了MYBATIS,记录一波      Mybatis简介 MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，是一个基于Java的持久层框架。  持久层： 可以将业务数据存储到磁盘，具备长期存储能力，只要磁盘不损坏，在断电或者其他情况下，重新开启系统仍">
<meta name="twitter:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-22.20.51.18-image.png">
    
    
        
          
              <link rel="shortcut icon" href="../../../../images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>ssm基础之MyBatis</title>
    <!-- styles -->
    <link rel="stylesheet" href="../../../../css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about.html">About</a></li><li><a href="../../../../archives/">Writing</a></li><li><a href="../../../../friends.html">Friends</a></li>
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="../../25/ssm整合/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="../Spring_mvc/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">回到顶部</span>
      <span id="i-share" class="info" style="display:none;">分享</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://p0rz9.github.io/2019/01/23/Mybatis/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://p0rz9.github.io/2019/01/23/Mybatis/&text=ssm基础之MyBatis"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://p0rz9.github.io/2019/01/23/Mybatis/&is_video=false&description=ssm基础之MyBatis"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ssm基础之MyBatis&body=Check out this article: https://p0rz9.github.io/2019/01/23/Mybatis/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://p0rz9.github.io/2019/01/23/Mybatis/&name=ssm基础之MyBatis&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mybatis简介"><span class="toc-number">1.</span> <span class="toc-text">Mybatis简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第一个Mybatis程序"><span class="toc-number">2.</span> <span class="toc-text">第一个Mybatis程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyBatis深入学习"><span class="toc-number">3.</span> <span class="toc-text">MyBatis深入学习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#编写日志输出环境配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">编写日志输出环境配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MyBatis高级映射"><span class="toc-number">3.2.</span> <span class="toc-text">MyBatis高级映射</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#一对一查询"><span class="toc-number">3.2.1.</span> <span class="toc-text">一对一查询</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#使用resultType-只能映射到一个确定的Java包装类"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">使用resultType    (只能映射到一个确定的Java包装类)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#使用-resultMap-实现"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">使用 resultMap 实现</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#一对多查询"><span class="toc-number">3.2.2.</span> <span class="toc-text">一对多查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-代理实例编写"><span class="toc-number">4.</span> <span class="toc-text">Mapper 代理实例编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注解开发MyBatis"><span class="toc-number">5.</span> <span class="toc-text">注解开发MyBatis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考链接"><span class="toc-number">6.</span> <span class="toc-text">参考链接</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ssm基础之MyBatis
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">P0rZ9's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-01-23T01:15:41.000Z" itemprop="datePublished">2019-01-23</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="../../../../tags/Java/">Java</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <blockquote>
<p>学习了MYBATIS,记录一波    </p>
</blockquote>
<h3 id="Mybatis简介"><a href="#Mybatis简介" class="headerlink" title="Mybatis简介"></a>Mybatis简介</h3><blockquote>
<p>MyBatis 本是apache的一个开源项目iBatis, 2010年这个项目由apache software foundation 迁移到了google code，并且改名为MyBatis，是一个基于Java的持久层框架。</p>
</blockquote>
<p><strong>持久层</strong>： 可以将业务数据存储到磁盘，具备长期存储能力，只要磁盘不损坏，在断电或者其他情况下，重新开启系统仍然可以读取到这些数据。<br><strong>优点</strong>： 可以使用巨大的磁盘空间存储相当量的数据，并且很廉价<br><strong>缺点</strong>：慢（相对于内存而言）</p>
<p><strong>为什么使用Mybatis</strong>        </p>
<blockquote>
<p>传统JDBC中,除了自己提供sql语句外,还必须操作Connection,Statement,ResultSet,非常繁琐。使用Mybatis后,只需要提供sql语句即可,我们只需要重点关注增删改查这些操作层面上。并且Mybatis支持使用简单的XML或注解来配置和映射原生信息,将接口和Java对象映射为数据库中的记录。            </p>
</blockquote>
<p>Mybatis运行程序原理图:<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-22.20.51.18-image.png" alt="2019-01-22.20.51.18-image.png"></p>
<pre><code>程序执行顺序:
1.应用程序找Mybatis要数据            
2.Mybatis从数据库找来数据        
    2.1 通过mybatis-config.xml定位数据库        
    2.2 通过User.xml执行对应的select语句        
    2.3 基于User.xml把返回的数据库记录封装在User对象中
    2.4 将多个User对象封装在一个User集合中        
3.返回一个User集合
</code></pre><h3 id="第一个Mybatis程序"><a href="#第一个Mybatis程序" class="headerlink" title="第一个Mybatis程序"></a>第一个Mybatis程序</h3><p>1.Maven pom.xml    </p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;/groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;version&gt;5.1.43&lt;/version&gt;
&lt;/dependency&gt;

&lt;!-- Mybatis依赖 --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;
    &lt;version&gt;3.4.4&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><p>2.Mybatis 配置文件 mybatis-config.xml<br>作用主要就是提供连接数据库用的驱动,数据名称,编码方式,账号密码等</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
        PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;

&lt;configuration&gt;


    &lt;typeAliases&gt;
        &lt;package name=&quot;com.test.pojo&quot;/&gt;
    &lt;/typeAliases&gt;

    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;transactionManager type=&quot;JDBC&quot;/&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis?characterEncoding=UTF-8&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;root&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;com/test/pojo/User.xml&quot;/&gt;
    &lt;/mappers&gt;

&lt;/configuration&gt;
</code></pre><p>3.配置文件User.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.test.pojo&quot;&gt;
    &lt;select id=&quot;listUser&quot; resultType=&quot;User&quot;&gt;
            select * from user
    &lt;/select&gt;

    &lt;insert id=&quot;addUser&quot; parameterType=&quot;User&quot;&gt;
        insert into user ( name ) values (#{name})
    &lt;/insert&gt;

    &lt;delete id=&quot;delUser&quot; parameterType=&quot;User&quot;&gt;
        delete from user where id = #{id}
    &lt;/delete&gt;

    &lt;select id=&quot;getUser&quot; parameterType=&quot;_int&quot; resultType=&quot;User&quot;&gt;
        select * from user where id=#{id}
    &lt;/select&gt;

    &lt;update id=&quot;updateUser&quot; parameterType=&quot;User&quot; &gt;
        update user set name = #{name} where id=#{id}
    &lt;/update&gt;

    &lt;!--模糊查询--&gt;
    &lt;select id=&quot;findUserByName&quot; parameterType=&quot;String&quot; resultType=&quot;User&quot;&gt;
        select * from user where name like &apos;%${value}%&apos;
    &lt;/select&gt;


&lt;/mapper&gt;
</code></pre><p>由于在主配置文件里配置了<code>&lt;typeAliases&gt;</code>别名,所以在这里的resultType可以直接写User,不用写全名pojo.User<br>namespace属性就是对SQL语句进行分类管理,实现不同业务的SQL隔离。            </p>
<p>4.测试类  TestMybatis.java    </p>
<pre><code>TestMybatis.java            
package com.test;

import java.io.IOException;
import java.io.InputStream;
import java.util.List;

import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;

import com.test.pojo.User;

public class TestMybatis {

public static void main(String[] args) throws IOException {
    String resource = &quot;mybatis-config.xml&quot;;
    InputStream inputStream = Resources.getResourceAsStream(resource);
    SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
    SqlSession session=sqlSessionFactory.openSession();


    //插入用户
    User user1 = new User();
    user1.setName(&quot;test1&quot;);
    session.insert(&quot;addUser&quot;,user1);

   //修改用户
    User user2 = session.selectOne(&quot;getUser&quot;,5);
    user2.setName(&quot;test_after&quot;);
    session.update(&quot;updateUser&quot;,user2);

    //删除用户
    User user3 = new User();
    user3.setId(3);
    session.delete(&quot;delUser&quot;,user3);

    //获取用户
    User user4 = session.selectOne(&quot;getUser&quot;,5);
    System.out.println(user4.getName());

    //模糊查询
    List&lt;User&gt; users = session.selectList(&quot;findUserByName&quot;,&quot;te&quot;);
    for(User user : users){
        System.out.println(user.getId()+&quot;:&quot;+user.getName());
    }

    //获取全部用户
    listAll(session);
    session.commit();
    session.close();
}

private static void listAll(SqlSession session){

    //列出全部用户
    List&lt;User&gt; users=session.selectList(&quot;listUser&quot;);
    for (User user : users) {
        System.out.println(user.getName());
    }
}
}
</code></pre><p>xml文件几个概念:<br>parameterType：指定输入参数类型,可为基本数据类型(int float)与包装数据类型(String Interger)以及用户编写的JavaBean类<br>resultType: 指定从数据库返回的信息对应的Java数据类型。</p>
<p>#{}： 占位符,该符号接收输入参数,花括号中编写参数名称来接收对应参数。当#{}接收简单类型时可用value或者其他名称来获取。<br>${}：表示拼接符,可在原有SQL语句上拼接新的符合SQL语法的语句。            </p>
<p>MyBatis使用场景:通过上面的入门程序,MyBatis的特点就是以Sql语句为核心的不完全的ORM(关系型映射)框架。使用场景为:对SQL语句优化要求比较高,项目需求经常变动。            </p>
<h3 id="MyBatis深入学习"><a href="#MyBatis深入学习" class="headerlink" title="MyBatis深入学习"></a>MyBatis深入学习</h3><h4 id="编写日志输出环境配置文件"><a href="#编写日志输出环境配置文件" class="headerlink" title="编写日志输出环境配置文件"></a>编写日志输出环境配置文件</h4><h4 id="MyBatis高级映射"><a href="#MyBatis高级映射" class="headerlink" title="MyBatis高级映射"></a>MyBatis高级映射</h4><h5 id="一对一查询"><a href="#一对一查询" class="headerlink" title="一对一查询"></a>一对一查询</h5><p>查询number对应的学生姓名。<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-22.23.40.15-image.png" alt="2019-01-22.23.40.15-image.png"></p>
<h6 id="使用resultType-只能映射到一个确定的Java包装类"><a href="#使用resultType-只能映射到一个确定的Java包装类" class="headerlink" title="使用resultType    (只能映射到一个确定的Java包装类)"></a>使用resultType    (只能映射到一个确定的Java包装类)</h6><p>1.首先更改主配置文件加载的<mappers>的内容:    </mappers></p>
<pre><code>  &lt;mappers&gt;
    &lt;mapper resource=&quot;com/test/pojo/Student.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><p>2.Student.xml            </p>
<pre><code>&lt;select id=&quot;findStudentByCard&quot; parameterType=&quot;_int&quot; resultType=&quot;Student&quot;&gt;
  SELECT
    student.*,
    card.*
  FROM
    student,card
  WHERE student.card_id = card.id AND card.number = #{value}
&lt;/select&gt;
</code></pre><h6 id="使用-resultMap-实现"><a href="#使用-resultMap-实现" class="headerlink" title="使用 resultMap 实现"></a>使用 resultMap 实现</h6><p>使用resultMap可以将数据字段映射到名称不一样的响应实体类属性中,重要的是可映射到实体类包裹的其他实体类。<br>1.首先更改主配置文件加载的<mappers>的内容:    </mappers></p>
<pre><code>  &lt;mappers&gt;
    &lt;mapper resource=&quot;com/test/pojo/Student.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><p>2.创建一个新的实体类(包含Student与card)<br>StudentWithCard.java </p>
<pre><code>package com.test.pojo;
  public class StudentWithCard {
    Student student;
    int number;
    int id;

      //geter and seter
  }
</code></pre><p>3.Student.xml</p>
<pre><code>&lt;mapper namespace=&quot;com.test.pojo&quot;&gt;
&lt;select id=&quot;findStudentByCard&quot; parameterType=&quot;_int&quot; resultMap=&quot;StudentInfoMap&quot;&gt;
  SELECT
    student.*,
    card.*
  FROM
    student,card
  WHERE student.card_id = card.id AND card.number = #{value}
&lt;/select&gt;

&lt;resultMap id=&quot;StudentInfoMap&quot; type=&quot;StudentWithCard&quot;&gt;
&lt;!-- id 标签表示对应的主键
     column 对应查询结果的列值
     property 对应封装类中的属性名称
--&gt;
      &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;
      &lt;result column=&quot;number&quot; property=&quot;number&quot;/&gt;
      &lt;!-- association 表示关联的嵌套结果，
           可以简单理解就是为封装类指定的标签
           --&gt;
      &lt;association property=&quot;student&quot; javaType=&quot;Student&quot;&gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot;/&gt;
        &lt;result column=&quot;name&quot; property=&quot;name&quot;/&gt;
        &lt;result column=&quot;card_id&quot; property=&quot;card_id&quot;/&gt;
      &lt;/association&gt;
&lt;/resultMap&gt;
&lt;/mapper&gt;
</code></pre><p>4.测试类(取出number为1111的学生的信息):</p>
<pre><code>StudentWithCard student = session.selectOne(&quot;findStudentByCard&quot;,1111);
System.out.println(student.getStudent().getName());
</code></pre><p>  <img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.11.35.57-image.png" alt="2019-01-23.11.35.57-image.png"></p>
<h5 id="一对多查询"><a href="#一对多查询" class="headerlink" title="一对多查询"></a>一对多查询</h5><p>查询选修了同一个班级的同学信息<br>  <img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.11.42.33-image.png" alt="2019-01-23.11.42.33-image.png"><br>1.首先更改主配置文件加载的<mappers>的内容:    </mappers></p>
<pre><code>&lt;mappers&gt;
  &lt;mapper resource=&quot;com/test/pojo/Class.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><p>2.创建class实体类    </p>
<pre><code>package com.test.pojo;
import java.util.List;
public class Class {
    private int id;
    private String name;
    private List&lt;Student&gt; students;
      //geter and seter
  }
</code></pre><p>3.映射文件Class.xml            </p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.test.pojo&quot;&gt;

    &lt;resultMap id=&quot;Students&quot; type=&quot;Student&quot;&gt;
        &lt;id column=&quot;student_id&quot; property=&quot;student_id&quot; /&gt;
        &lt;result column=&quot;name&quot; property=&quot;name&quot; /&gt;
    &lt;/resultMap&gt;

    &lt;select id=&quot;listStudentByClassName&quot; parameterType=&quot;String&quot; resultMap=&quot;Students&quot;&gt;
        select student.* from student, class where student.student_id = class.student_id and class.name = #{value}
    &lt;/select&gt;
&lt;/mapper&gt;
</code></pre><p>子元素说明:<br>  id: 设置主键字段与模型属性的映射关系<br>  result: 设置普通字段与模型属性的关系            </p>
<p>配置属性:<br>  property: 映射到JavaBean的属性名称<br>  column: 数据表的列名或者标签别名<br>  javaType: 一个完整的类名,匹配的是一个JavaBean,MyBatis会自动检测</p>
<p>4.测试类(输出课程为Java课的学生信息):</p>
<pre><code>List&lt;Student&gt; students = session.selectList(&quot;listStudentByClassName&quot;,&quot;Java课&quot;);
for (Student student : students){
    System.out.println(&quot;ID:&quot;+student.getStudent_id()+&quot;,NAME:&quot;+student.getName());
}  
</code></pre><p>  <img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-01-23.12.28.48-image.png" alt="2019-01-23.12.28.48-image.png"></p>
<p>结合sql语句与映射文件,就可以很方便的操作数据库        </p>
<h3 id="Mapper-代理实例编写"><a href="#Mapper-代理实例编写" class="headerlink" title="Mapper 代理实例编写"></a>Mapper 代理实例编写</h3><p>1.Mybatis-config.xml        </p>
<pre><code>&lt;mappers&gt;
    &lt;mapper resource=&quot;com/test/pojo/StudentMapper.xml&quot;/&gt;
&lt;/mappers&gt;
</code></pre><p>2.StudentMapper.xml        </p>
<pre><code>  &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE mapper
        PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;

&lt;mapper namespace=&quot;com.test.pojo.mapper.StudentMapper&quot;&gt;
    &lt;!-- 查询学生 --&gt;
    &lt;select id=&quot;findStudentById&quot; parameterType=&quot;_int&quot; resultType=&quot;com.test.pojo.Student&quot;&gt;
        SELECT * FROM student WHERE student_id = #{id}
    &lt;/select&gt;
    &lt;!-- 增加用户 --&gt;
    &lt;insert id=&quot;insertStudent&quot; parameterType=&quot;com.test.pojo.Student&quot;&gt;
        INSERT INTO student(student_id, name) VALUES(#{id}, #{name})
    &lt;/insert&gt;
    &lt;!-- 删除用户 --&gt;
    &lt;delete id=&quot;deleteStudent&quot; parameterType=&quot;_int&quot;&gt;
        DELETE FROM student WHERE student_id = #{id}
    &lt;/delete&gt;
    &lt;!-- 修改用户 --&gt;
    &lt;update id=&quot;updateStudent&quot; parameterType=&quot;com.test.pojo.Student&quot;&gt;
        UPDATE student SET name = #{name} WHERE student_id = #{id}
    &lt;/update&gt;
&lt;/mapper&gt;
</code></pre><p>如果需要使用StudentMapper.xml的Mapper代理,需要先定义一个接口,名为StudentMapper,然后新建方法定义,分别对应配置文件的增删改查配置,然后将StudentMapper中的namespace改为接口定义的地方,即可在业务类中使用Mapper代理。<br>3.StudentMapper.java接口类(pojo/mapper/StudentMapper.java)    </p>
<pre><code>package com.test.pojo.mapper;
import com.test.pojo.Student;
public interface StudentMapper {

    // 根据 id 查询学生信息
    public Student findStudentById(int id) throws Exception;

    // 添加学生信息
    public void insertStudent(Student student) throws Exception;

    // 删除学生信息
    public void deleteStudent(int id) throws Exception;

    // 修改学生信息
    public void updateStudent(Student student) throws Exception;
}
</code></pre><p>4.测试类Test.java            </p>
<pre><code>  package com.test;

import java.io.InputStream;
import com.test.pojo.Student;
import com.test.pojo.mapper.StudentMapper;
import org.apache.ibatis.io.Resources;
import org.apache.ibatis.session.SqlSession;
import org.apache.ibatis.session.SqlSessionFactory;
import org.apache.ibatis.session.SqlSessionFactoryBuilder;



public class Test {

    public static void main(String[] args) throws Exception {
        String resource = &quot;mybatis-config.xml&quot;;
        InputStream inputStream = Resources.getResourceAsStream(resource);
        SqlSessionFactory sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
        SqlSession session=sqlSessionFactory.openSession();

        // 获取Mapper代理
        StudentMapper studentMapper = session.getMapper(StudentMapper.class);


        //执行 Mapper 代理独享的查询方法
        Student student = studentMapper.findStudentById(1);
        System.out.println(student.getName());

        //insertStudent
        Student student1 = new Student();
        student1.setName(&quot;test_1&quot;);
        student1.setStudent_id(3);
        studentMapper.insertStudent(student1);

        //deleteStudent
        studentMapper.deleteStudent(3);

        //updateStudent
        Student student2 = new Student();
        student2.setStudent_id(2);
        student2.setName(&quot;student_2&quot;);
        studentMapper.updateStudent(student2);

        session.close();
    }}
</code></pre><h3 id="注解开发MyBatis"><a href="#注解开发MyBatis" class="headerlink" title="注解开发MyBatis"></a>注解开发MyBatis</h3><p>依照刚才Mapper的例子:<br>1.我们将StudentMapper.xml的配置的sql语句用注释配置在StudentMapper接口中:</p>
<pre><code>  public interface StudentMapper {

    // 根据 id 查询学生信息
    @Select(&quot;SELECT * FROM student WHERE student_id = #{id}&quot;)
    public Student findStudentById(int id) throws Exception;

    // 添加学生信息
    @Insert(&quot;INSERT INTO student(student_id, name) VALUES(#{id}, #{name})&quot;)
    public void insertStudent(Student student) throws Exception;

    // 删除学生信息
    @Delete(&quot;DELETE FROM student WHERE student_id = #{id}&quot;)
    public void deleteStudent(int id) throws Exception;

    // 修改学生信息
    @Update(&quot;UPDATE student SET name = #{name} WHERE student_id = #{id}&quot;)
    public void updateStudent(Student student) throws Exception;
}
</code></pre><p>2.修改mybatis-config.xml(将之前配置的映射注释掉)</p>
<pre><code>&lt;!-- 映射文件 --&gt;
&lt;mappers&gt;
    &lt;!--&lt;mapper resource=&quot;com/test/pojo/StudentMapper.xml&quot;/&gt;--&gt;
    &lt;mapper class=&quot;com.test.pojo.mapper.StudentMapper&quot;/&gt;
&lt;/mappers&gt;
</code></pre><p>3.测试类代码不变,即可运行程序            </p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><p><a href="https://www.jianshu.com/p/c77e3691867d" target="_blank" rel="noopener">https://www.jianshu.com/p/c77e3691867d</a><br><a href="http://how2j.cn/k/mybatis/mybatis-tutorial/1087.html" target="_blank" rel="noopener">http://how2j.cn/k/mybatis/mybatis-tutorial/1087.html</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="../../../../index.html">Home</a></li>
         
          <li><a href="../../../../about.html">About</a></li>
         
          <li><a href="../../../../archives/">Writing</a></li>
         
          <li><a href="../../../../friends.html">Friends</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#Mybatis简介"><span class="toc-number">1.</span> <span class="toc-text">Mybatis简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#第一个Mybatis程序"><span class="toc-number">2.</span> <span class="toc-text">第一个Mybatis程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MyBatis深入学习"><span class="toc-number">3.</span> <span class="toc-text">MyBatis深入学习</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#编写日志输出环境配置文件"><span class="toc-number">3.1.</span> <span class="toc-text">编写日志输出环境配置文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MyBatis高级映射"><span class="toc-number">3.2.</span> <span class="toc-text">MyBatis高级映射</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#一对一查询"><span class="toc-number">3.2.1.</span> <span class="toc-text">一对一查询</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#使用resultType-只能映射到一个确定的Java包装类"><span class="toc-number">3.2.1.1.</span> <span class="toc-text">使用resultType    (只能映射到一个确定的Java包装类)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#使用-resultMap-实现"><span class="toc-number">3.2.1.2.</span> <span class="toc-text">使用 resultMap 实现</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#一对多查询"><span class="toc-number">3.2.2.</span> <span class="toc-text">一对多查询</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mapper-代理实例编写"><span class="toc-number">4.</span> <span class="toc-text">Mapper 代理实例编写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#注解开发MyBatis"><span class="toc-number">5.</span> <span class="toc-text">注解开发MyBatis</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#参考链接"><span class="toc-number">6.</span> <span class="toc-text">参考链接</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://p0rz9.github.io/2019/01/23/Mybatis/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://p0rz9.github.io/2019/01/23/Mybatis/&text=ssm基础之MyBatis"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://p0rz9.github.io/2019/01/23/Mybatis/&is_video=false&description=ssm基础之MyBatis"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ssm基础之MyBatis&body=Check out this article: https://p0rz9.github.io/2019/01/23/Mybatis/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://p0rz9.github.io/2019/01/23/Mybatis/&title=ssm基础之MyBatis"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://p0rz9.github.io/2019/01/23/Mybatis/&name=ssm基础之MyBatis&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> 目录</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> 顶部</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> 菜单</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    版权所有 &copy; 2019 P0rZ9
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about.html">About</a></li><li><a href="../../../../archives/">Writing</a></li><li><a href="../../../../friends.html">Friends</a></li>
      </ul>
    </nav>
  </div>
</footer>



</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="../../../../lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../../../../lib/meslo-LG/styles.css">
<link rel="stylesheet" href="../../../../lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="../../../../lib/jquery/jquery.min.js"></script>
<script src="../../../../lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="../../../../js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


